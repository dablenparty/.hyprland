# Maintainer: Your Name <youremail@domain.com>
pkgname=Hyprland-git
pkgver=0.47.0.r172.gc7f0519
pkgrel=2
pkgdesc="Hyprland provides the latest Wayland features, dynamic tiling, all the eyecandy, powerful plugins and much more, while still being lightweight and responsive"
arch=(x86_64)
url="https://hyprland.org/"
license=('GPL')
depends=(
  aquamarine-git
  blueman
  cairo
  cpio
  egl-wayland
  foot
  git
  hyprcursor-git
  hyprgraphics-git
  hypridle-git
  hyprland-qtutils-git
  hyprlang-git
  hyprlock-git
  hyprpolkitagent-git
  hyprshot-git
  hyprutils-git
  kitty
  libdisplay-info
  libinput
  libliftoff
  libx11
  libxcb
  libxcomposite
  libxcursor
  libxfixes
  libxkbcommon
  libxrender
  mako
  nwg-look
  obsidian
  pango
  perl-image-exiftool
  pixman
  python-pywal16
  qt5-wayland
  qt6-wayland
  re2
  rofi-wayland
  sddm
  seatd
  swww
  tesseract
  tomlplusplus
  ttf-font-awesome
  upscayl-ncnn
  uwsm
  waybar
  wayland-protocols
  waypaper
  wl-clipboard
  xcb-proto
  xcb-util
  xcb-util-errors
  xcb-util-keysyms
  xcb-util-wm
  xdg-desktop-portal-gtk-git
  xdg-desktop-portal-hyprland-git
  xorg-xwayland
  yazi
)
makedepends=(
  cmake
  hyprwayland-scanner-git
  gcc
  glaze
  meson
  ninja
)
provides=("hyprland" "wayland-compositor")
conflicts=(hyprland Hyprland hyprland-git)
source=("git+https://github.com/hyprwm/Hyprland.git")
sha256sums=(SKIP)

prepare() {
  cd "$srcdir/Hyprland" || exit 1
  git submodule update --init --remote --recursive --rebase
}

pkgver() {
  cd "$srcdir/Hyprland" || exit 1
  # from: https://wiki.archlinux.org/title/VCS_package_guidelines#The_pkgver()_function
  git describe --long --tags --abbrev=7 | sed 's/^v//;s/\([^-]*-g\)/r\1/;s/-/./g'
}

build() {
  cd "$srcdir/Hyprland" || exit 1
  make all
}

package() {
  cd "$srcdir/Hyprland" || exit 1
  make install DESTDIR="$pkgdir/"

  # license
  install -Dm644 -t "$pkgdir/usr/share/licenses/$pkgname" LICENSE
}
